<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¤ºä¾‹è¯¾è¡¨æ–‡ä»¶ç”Ÿæˆå™¨</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f7fa;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .description {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border-left: 4px solid #4c6ef5;
        }
        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 30px;
        }
        .btn {
            padding: 12px 24px;
            background: #4c6ef5;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
        }
        .btn:hover {
            background: #364fc7;
        }
        .btn-secondary {
            background: #868e96;
        }
        .btn-secondary:hover {
            background: #495057;
        }
        .format-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        .format-table th,
        .format-table td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: left;
        }
        .format-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        .format-table tr:nth-child(even) {
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š ç¤ºä¾‹è¯¾è¡¨æ–‡ä»¶ç”Ÿæˆå™¨</h1>
        
        <div class="description">
            <h3>ğŸ¯ ä½¿ç”¨è¯´æ˜</h3>
            <p>è¿™ä¸ªå·¥å…·å¯ä»¥å¸®ä½ ç”Ÿæˆç¤ºä¾‹è¯¾è¡¨Excelæ–‡ä»¶ï¼Œç”¨äºæµ‹è¯•è¯¾è¡¨æŸ¥çœ‹å™¨çš„å¯¼å…¥åŠŸèƒ½ã€‚</p>
            <ul>
                <li>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®ç”Ÿæˆä¸åŒç±»å‹çš„ç¤ºä¾‹æ–‡ä»¶</li>
                <li>ä¸‹è½½åå¯ä»¥ç›´æ¥å¯¼å…¥åˆ°è¯¾è¡¨æŸ¥çœ‹å™¨ä¸­æµ‹è¯•</li>
                <li>ä¹Ÿå¯ä»¥åŸºäºç¤ºä¾‹æ–‡ä»¶æ ¼å¼åˆ¶ä½œä½ è‡ªå·±çš„è¯¾è¡¨</li>
            </ul>
        </div>

        <div class="button-group">
            <button class="btn" onclick="generateStandardSchedule()">ç”Ÿæˆæ ‡å‡†è¯¾è¡¨</button>
            <button class="btn btn-secondary" onclick="generateSimpleSchedule()">ç”Ÿæˆç®€åŒ–è¯¾è¡¨</button>
            <button class="btn btn-secondary" onclick="generateEnglishSchedule()">ç”Ÿæˆè‹±æ–‡è¯¾è¡¨</button>
        </div>

        <div class="description">
            <h3>ğŸ“‹ æ”¯æŒçš„æ–‡ä»¶æ ¼å¼</h3>
            <table class="format-table">
                <thead>
                    <tr>
                        <th>åˆ—åï¼ˆä¸­æ–‡ï¼‰</th>
                        <th>åˆ—åï¼ˆè‹±æ–‡ï¼‰</th>
                        <th>ç¤ºä¾‹å†…å®¹</th>
                        <th>æ˜¯å¦å¿…éœ€</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>è¯¾ç¨‹åç§°</td>
                        <td>Course</td>
                        <td>é«˜ç­‰æ•°å­¦</td>
                        <td>âœ… æ˜¯</td>
                    </tr>
                    <tr>
                        <td>ä¸Šè¯¾æ—¶é—´</td>
                        <td>Time</td>
                        <td>1-16å‘¨æ˜ŸæœŸä¸€3-4èŠ‚</td>
                        <td>âœ… æ˜¯</td>
                    </tr>
                    <tr>
                        <td>ä¸Šè¯¾åœ°ç‚¹</td>
                        <td>Location</td>
                        <td>æ•™å­¦æ¥¼A101</td>
                        <td>âŒ å¦</td>
                    </tr>
                    <tr>
                        <td>ä¸Šè¯¾æ•™å¸ˆ</td>
                        <td>Teacher</td>
                        <td>å¼ æ•™æˆ</td>
                        <td>âŒ å¦</td>
                    </tr>
                    <tr>
                        <td>æ•™å­¦ç­å·</td>
                        <td>Class ID</td>
                        <td>CS001-01</td>
                        <td>âŒ å¦</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="description">
            <h3>â° æ—¶é—´æ ¼å¼ç¤ºä¾‹</h3>
            <ul>
                <li><code>1-16å‘¨æ˜ŸæœŸä¸€3-4èŠ‚</code> - ç¬¬1-16å‘¨ï¼Œæ˜ŸæœŸä¸€ç¬¬3-4èŠ‚</li>
                <li><code>1-4,6-17å‘¨æ˜ŸæœŸä¸‰8-9èŠ‚</code> - ç¬¬1-4å‘¨å’Œç¬¬6-17å‘¨ï¼Œæ˜ŸæœŸä¸‰ç¬¬8-9èŠ‚</li>
                <li><code>12-15å‘¨æ˜ŸæœŸäº”8-9èŠ‚</code> - ç¬¬12-15å‘¨ï¼Œæ˜ŸæœŸäº”ç¬¬8-9èŠ‚</li>
                <li><code>10å‘¨</code> - ç¬¬10å‘¨ï¼ˆå®è·µè¯¾ç­‰ï¼‰</li>
            </ul>
        </div>
    </div>

    <!-- SheetJSåº“ -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    
    <script>
        // ç”Ÿæˆæ ‡å‡†è¯¾è¡¨ç¤ºä¾‹
        function generateStandardSchedule() {
            const data = [
                ['è¯¾ç¨‹åç§°', 'æ•™å­¦ç­å·', 'ä¸Šè¯¾æ—¶é—´', 'ä¸Šè¯¾åœ°ç‚¹', 'ä¸Šè¯¾æ•™å¸ˆ'],
                ['é«˜ç­‰æ•°å­¦', 'MATH001-01', '1-16å‘¨æ˜ŸæœŸä¸€3-4èŠ‚', 'æ•™å­¦æ¥¼A101', 'å¼ æ•™æˆ'],
                ['å¤§å­¦è‹±è¯­', 'ENG001-02', '1-18å‘¨æ˜ŸæœŸäºŒ1-2èŠ‚', 'å¤–è¯­æ¥¼201', 'æè€å¸ˆ'],
                ['ç¨‹åºè®¾è®¡åŸºç¡€', 'CS001-01', '1-16å‘¨æ˜ŸæœŸä¸‰6-7èŠ‚', 'è®¡ç®—æœºæ¥¼301', 'ç‹è€å¸ˆ'],
                ['ä½“è‚²', 'PE001-05', '1-18å‘¨æ˜ŸæœŸå››3-4èŠ‚', 'ä½“è‚²é¦†', 'èµµæ•™ç»ƒ'],
                ['å¤§å­¦ç‰©ç†', 'PHY001-01', '1-16å‘¨æ˜ŸæœŸäº”1-2èŠ‚', 'ç†å­¦æ¥¼202', 'å­™æ•™æˆ'],
                ['ç‰©ç†å®éªŒ', 'PHY001-01E', '2,4,6,8,10,12,14,16å‘¨æ˜ŸæœŸäº”6-8èŠ‚', 'ç‰©ç†å®éªŒå®¤', 'å­™æ•™æˆ'],
                ['æ€æƒ³æ”¿æ²»ç†è®º', 'POL001-01', '1-18å‘¨æ˜ŸæœŸä¸€8-9èŠ‚', 'äººæ–‡æ¥¼101', 'é™ˆè€å¸ˆ']
            ];

            downloadExcel(data, 'æ ‡å‡†è¯¾è¡¨ç¤ºä¾‹.xlsx');
        }

        // ç”Ÿæˆç®€åŒ–è¯¾è¡¨ç¤ºä¾‹
        function generateSimpleSchedule() {
            const data = [
                ['è¯¾ç¨‹', 'æ—¶é—´', 'åœ°ç‚¹', 'æ•™å¸ˆ'],
                ['æ•°å­¦', '1-16å‘¨æ˜ŸæœŸä¸€1-2èŠ‚', 'A101', 'å¼ è€å¸ˆ'],
                ['è‹±è¯­', '1-18å‘¨æ˜ŸæœŸäºŒ3-4èŠ‚', 'B201', 'æè€å¸ˆ'],
                ['è®¡ç®—æœº', '1-16å‘¨æ˜ŸæœŸä¸‰5-6èŠ‚', 'C301', 'ç‹è€å¸ˆ'],
                ['ä½“è‚²', '1-18å‘¨æ˜ŸæœŸå››7-8èŠ‚', 'ä½“è‚²é¦†', 'èµµè€å¸ˆ']
            ];

            downloadExcel(data, 'ç®€åŒ–è¯¾è¡¨ç¤ºä¾‹.xlsx');
        }

        // ç”Ÿæˆè‹±æ–‡è¯¾è¡¨ç¤ºä¾‹
        function generateEnglishSchedule() {
            const data = [
                ['Course', 'Class ID', 'Time', 'Location', 'Teacher'],
                ['Advanced Mathematics', 'MATH101-01', '1-16å‘¨æ˜ŸæœŸä¸€3-4èŠ‚', 'Building A Room 101', 'Prof. Zhang'],
                ['College English', 'ENG101-02', '1-18å‘¨æ˜ŸæœŸäºŒ1-2èŠ‚', 'Language Building 201', 'Ms. Li'],
                ['Programming Basics', 'CS101-01', '1-16å‘¨æ˜ŸæœŸä¸‰6-7èŠ‚', 'Computer Building 301', 'Dr. Wang'],
                ['Physical Education', 'PE101-05', '1-18å‘¨æ˜ŸæœŸå››3-4èŠ‚', 'Gymnasium', 'Coach Zhao']
            ];

            downloadExcel(data, 'English_Schedule_Sample.xlsx');
        }

        // ä¸‹è½½Excelæ–‡ä»¶
        function downloadExcel(data, filename) {
            // åˆ›å»ºå·¥ä½œç°¿
            const wb = XLSX.utils.book_new();
            
            // åˆ›å»ºå·¥ä½œè¡¨
            const ws = XLSX.utils.aoa_to_sheet(data);
            
            // è®¾ç½®åˆ—å®½
            const colWidths = [
                {wch: 20}, // è¯¾ç¨‹åç§°
                {wch: 15}, // ç­å·
                {wch: 25}, // æ—¶é—´
                {wch: 20}, // åœ°ç‚¹
                {wch: 15}  // æ•™å¸ˆ
            ];
            ws['!cols'] = colWidths;

            // æ·»åŠ å·¥ä½œè¡¨åˆ°å·¥ä½œç°¿
            XLSX.utils.book_append_sheet(wb, ws, 'è¯¾è¡¨');
            
            // å¯¼å‡ºæ–‡ä»¶
            XLSX.writeFile(wb, filename);
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            showMessage('âœ… ç¤ºä¾‹æ–‡ä»¶å·²ç”Ÿæˆå¹¶å¼€å§‹ä¸‹è½½ï¼');
        }

        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(message) {
            let messageEl = document.getElementById('message');
            if (!messageEl) {
                messageEl = document.createElement('div');
                messageEl.id = 'message';
                messageEl.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #4CAF50;
                    color: white;
                    padding: 15px 20px;
                    border-radius: 5px;
                    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                    z-index: 1000;
                    animation: slideIn 0.3s ease;
                `;
                document.body.appendChild(messageEl);
            }
            
            messageEl.textContent = message;
            messageEl.style.display = 'block';
            
            setTimeout(() => {
                messageEl.style.display = 'none';
            }, 3000);
        }

        // æ·»åŠ CSSåŠ¨ç”»
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
